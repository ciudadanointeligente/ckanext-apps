<html xmlns:py="http://genshi.edgewall.org/"
  xmlns:i18n="http://genshi.edgewall.org/i18n"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  py:attrs="{'class':'has-errors'} if c.errors else {}"
      >
 <py:def function="page_title">Create/Update Ideas</py:def>
 
 <py:def function="optional_head">
  <link rel="stylesheet" href="${g.site_url}/css/forms.css" type="text/css" media="screen, print" />

  <!-- Reveal instructions --> 
  <script type="text/javascript" src="${g.site_url}/scripts/reveal_instructions.js"></script> 
  <link rel="stylesheet" href="${g.site_url}/css/reveal_instructions.css" /> 

  <!-- Flexitable --> 
  <script type="text/javascript" src="${g.site_url}/scripts/flexitable.js"></script> 
  <link rel="stylesheet" href="${g.site_url}/css/flexitable.css" /> 

  <!-- Tagcomplete --> 
  <script type="text/javascript" src="${g.site_url}/scripts/tagcomplete.js"></script> 
  <link rel="stylesheet" href="${g.site_url}/css/tagcomplete.css" /> 
 </py:def>

  <div py:match="content">
    <h3 py:if="c.auth_for_create">Submit a New Idea</h3>
    <h3 py:if="c.auth_for_update">Update Existing Idea</h3>
    <p>All idea submissions are reviewed and must be approved before they will display on the site.</p>

    <?python
        form_attributes = {}
        if c.errors:
            form_attributes['class'] = 'has-errors'
        if c.auth_for_create:
            form_attributes['id'] = 'ideas-create'
            form_attributes['action'] = '/ideas'
        elif c.auth_for_update:
            form_attributes['id'] = 'ideas-update'
            form_attributes['action'] = '/ideas/' + c.params.get('name')
    ?>
    <form action="/ideas" method="post"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      py:attrs="form_attributes"
      >
     <input py:if="c.auth_for_update" type="hidden" name="_method" value="PUT" />
     <fieldset>
      <legend>Idea Information</legend>
      <py:if test="c.errors">
        <div class="error-explanation">
            <h2>Errors in form</h2> 
            <p>The form contains invalid entries:</p> 
            <ul>
              <li py:for="error in c.errors">
                  ${_(error)}
              </li>
            </ul> 
        </div>
      </py:if>
      
     <dl>
        <dt>
        <label class="field_req" for="title">
        What is your idea?
        *
        </label>
        </dt>
        <dd>
        <input id="title" name="title" type="text" value="${c.params.get('title')}" />
        </dd>
        
        
        <dt>
        <label class="field_opt" for="tags">
        Tags
        </label>
        </dt>
        <dd>
        <input class="long tagComplete" data-tagcomplete-queryparam="incomplete" data-tagcomplete-url="/api/2/util/tag/autocomplete" id="tags" name="tags" size="60" type="text" value="${c.params.get('tags')}" />
        <div class="tags small"></div>
        </dd>
        <dd class="instructions basic">Terms that may link this application to similar ones. For more information on conventions, see <a href="http://wiki.okfn.org/ckan/doc/faq#TagConventions">this wiki page</a>.</dd>
        <dd class="hints">e.g. pollution rivers water-quality</dd>
        
        
        <dt>
        <label class="field_opt" for="description">
        Description
        </label>
        </dt>
        <dd>
        <textarea cols="60" id="description" name="description" rows="15">${c.params.get('description')}</textarea>
        </dd>
        <dd class="instructions basic">The main description of the application<span class="more">&nbsp;</span></dd>
        <dd class="instructions further" style="display: none; ">It is often displayed with the application name. In particular, it should start with a short sentence that describes the application succinctly, because the first few words alone may be used in some views of the applications.</dd>
        <dd class="hints">You can use <a href="http://daringfireball.net/projects/markdown/syntax">Markdown formatting</a> here.</dd>
        
      </dl>
      </fieldset>
      
        <div class="ckan_logged_in" style="display: none;">
  	<p>Submitter: ${c.author}</p>
        </div>
        <div class="ckan_logged_out">
          <label>Submitter: ${c.author}</label>
          <p class="hints">
          Since you have not signed in this will just be your IP address.
          <a href="${h.url_for(controller='user', action='login', id=None)}" target="_blank">Click here to sign in</a> before saving (opens in new window).
          </p>
        </div>
        <input type="hidden" name="submitter" value="${c.author}" />
      <div class="submit">
              <input id="save" name="save" type="submit" value="Save" />
            </div>
    </form>
  
  </div>
  
  <xi:include href="../../layout.html" />
</html>